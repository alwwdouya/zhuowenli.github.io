<!DOCTYPE html>
<html lang="cn">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

    <link rel="dns-prefetch" href="//disqus.com"/>
    <link rel="dns-prefetch" href="//a.disquscdn.com"/>

    <meta name="Keywords" content="卓文理,前端,前端开发,网页设计,交互设计,svg,elastic,button,snap.svg,javascript"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"/>
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="black" name="apple-mobile-web-app-status-bar-style" />
    <meta content="telephone=no" name="format-detection" />
    
    <meta name="author" content="卓文理">

    <link rel="apple-touch-icon-precomposed" href="/res/img/icon.png">
    <link rel="apple-touch-icon-precomposed" href="/res/img/icon-72.png" sizes="72x72" />
    <link rel="apple-touch-icon-precomposed" href="/res/img/icon-76.png" sizes="76x76" />
    <link rel="apple-touch-icon-precomposed" href="/res/img/icon-114.png" sizes="114x114" />
    <link rel="apple-touch-icon-precomposed" href="/res/img/icon-120.png" sizes="120x120" />
    <link rel="apple-touch-icon-precomposed" href="/res/img/icon-152.png" sizes="152x152" />
    <link href="/res/img/icon.png" rel="Shortcut Icon" type="image/x-icon"/>

    <title>SVG动画：弹性按钮 | 卓文理</title>

    
    <link rel="stylesheet" href="/res/css/style.css">
    <script type="text/javascript" src="/res/js/jquery-2.1.1.min.js"></script>
</head>
<body>
    <div id="container" class="container modify">
        <main id="postPage" class="page post-page post-detail">
                <div class="post-menu">
        <a href="/" class="uplevel">
            <span class="arrow">‹</span>
            <strong class="logo">
                <span class="a">卓</span>
                <span class="b">文</span>
                <span class="c">理</span>
            </strong>
            <h1>前端开发</h1>
        </a>
        <ul class="stats">
            <li>
                <p>本站站长</p>
                <p><a target="_blank" href="http://www.zwlme.com">卓文理</a></p>
            </li>
            <li>
                <p>联系方式</p>
                <p><a target="_blank" href="mailto:531840344@qq.com">531840344@qq.com</a></p>
            </li>
        </ul>
    </div>
            <div class="post-container">
                <div class="article">
                    <a href="/codebase" class="back">
                        <span class="arrow">&lt;</span>
                        <span class="text">返回目录</span>
                    </a>
                    <header class="article-info">
                        <h1>SVG动画：弹性按钮</h1>
                    </header>
                    <div class="article-body">
                        <p>可缩放矢量图形 (<a href="http://www.w3.org/TR/SVG11/intro.html">SVG</a>) 是用于在 XML 中描述二维图形的一种语言，也是 <a href="http://www.w3.org/TR/SVG11/intro.html">W3C推荐</a>语言。SVG 允许使用三种类型的图形对象：矢量图形（例如由直线和曲线组成的路径）、图像和文本。</p>

<p>SVG 绘图可以是交互式和动态的。例如，可使用脚本来定义和触发动画。</p>

<p>从本章开始，我会逐步给大家讲解关于SVG动画的一些实现，以及SVG的一些基本概念。</p>

<p>SVG采用的是使用文本来定义图形，这种文档结构非常适合于创建动画。要改变图形的位置、大小和颜色，只需要调整相应的属性就可以了。事实上，SVG有为各种事件处理而专门设计的属性，甚至很多还是专门为动画量身定做的。在SVG中，实现动画可以有下面几种方式：</p>

<ul>
<li>使用SVG的动画元素。这个下面会重点介绍。</li>
<li>使用JavaScript。采用DOM操作启动和控制动画，本文及以后将大量采用这种方式来进行动画操作。</li>
<li><a href="http://www.w3.org/TR/2008/REC-SMIL3-20081201/">SMIL(Synchronized Multimedia Integration Language)</a>。</li>
</ul>

<p>现代浏览器基本上都支持SVG：<a href="http://caniuse.com/#search=svg">查看</a></p>

<p><img src="/img/post/SVGButton/1.png" alt=""></p>

<p>ok，接下来进入正文。</p>

<hr>

<h2>弹性按钮</h2>

<p>今天我给大家分享的是弹性按钮的实现。</p>

<p>大家应该发现了。本站首页底部的<em>下一页</em>按钮，以及本文的<em>View Demo</em>、<em>Download Soure</em>等按钮，有个很酷炫的的点击效果。这是怎么实现的呢？</p>

<p>我实现的方法是将这个SVG按钮封装成一个组件，然后当用户点击按钮的时候，将svg按钮的路径替换成另外一个带有弹性的路径。</p>

<p><em>路径(path)：在SVG的形状标签里，path是最强大的一个，掌握了path就足够处理常见的绘图问题了。有用过AI(Adobe Illustrator)的就知道，用路径工具可以画出直线和曲线，最终闭合后可以形成一个自定义形状图形。SVG的路径也是同样的道理。</em></p>

<p>这样可以使按钮的效果更有趣，让交互效果显得更自然。当然，物极必反。在我们实际的使用中最好把握一个度，不要滥用效果，这可能会得不偿失。</p>

<p>好处也是相当的。特别是在移动端上。点击按钮能够反馈给用户更加流畅的动画效果，而不是死板的边框，变色等。</p>

<p>我们用到了<a href="http://snapsvg.io/">Snap.svg</a>这个在现代浏览器下性能非常好的SVG动画插件。</p>

<p>下个是一个按钮的案例：</p>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"nav-link"</span> <span class="na">href=</span><span class="s">"/page"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"button"</span> <span class="na">data-morph-active=</span><span class="s">"M286.5,62.5c0,27.891-22.609,50.5-50.5,50.5c0,0-64.355-6-86-6c-21.645,0-86,6-86,6c-27.891,0-50.5-22.609-50.5-50.5l0,0C13.5,34.609,36.109,12,64,12c0,0,64.355,6,86,6c21.645,0,86-6,86-6C263.891,12,286.5,34.609,286.5,62.5L286.5,62.5z"</span><span class="nt">&gt;</span>

        <span class="nt">&lt;svg</span> <span class="na">width=</span><span class="s">"100%"</span> <span class="na">height=</span><span class="s">"100%"</span> <span class="na">viewBox=</span><span class="s">"0 0 300 125"</span> <span class="na">preserveAspectRatio=</span><span class="s">"none"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;path</span> <span class="na">d=</span><span class="s">"M286.5,62.5C286.5,90.39099999999999,263.891,113,236,113C236,113,171.64499999999998,113,150,113C128.355,113,64,113,64,113C36.109,113,13.5,90.39099999999999,13.5,62.5C13.5,62.5,13.5,62.5,13.5,62.5C13.5,34.609,36.109,12,64,12C64,12,128.35500000000002,12,150,12C171.645,12,236,12,236,12C263.891,12,286.5,34.609,286.5,62.5C286.5,62.5,286.5,62.5,286.5,62.5C286.5,62.5,286.5,62.5,286.5,62.5"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/svg&gt;</span>

    <span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"text"</span><span class="nt">&gt;</span>按钮<span class="nt">&lt;/span&gt;</span>

<span class="nt">&lt;/a&gt;</span>
</code></pre></div>
<p>SVG放到<code>span.button</code>标签里面，用<code>data-morph-active</code>来保存点击后的路径，默认的路径就是<code>svg path</code>的<code>d</code>属性。当我们需要执行动画的时候，就把这两个元素对掉。</p>

<p>怎么获取到SVG的<code>path</code>？</p>

<p>我们可以通过API的路径工具来画一个形状出来。</p>

<p><img src="/img/post/SVGButton/2.png" alt=""></p>

<p>导出SVG文件。然后，通过编辑器打开这个SVG文件。就可以看到是一个类似XML的代码，接下来复制粘贴就行了。</p>

<p><img src="/img/post/SVGButton/3.png" alt=""></p>

<p><code>span.button</code>通过绝对路径放入<code>a.nav-link</code>，并且宽高100%。当svg原始宽高大于外层固定的宽高时，它会按比例压缩大小。</p>
<div class="highlight"><pre><code class="language-scss" data-lang="scss"><span class="c1">// scss
</span><span class="nc">.nav-link</span><span class="p">{</span>
    <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span> <span class="m">10px</span><span class="p">;</span>
    <span class="nl">display</span><span class="p">:</span> <span class="n">inline-block</span><span class="p">;</span>
    <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">9em</span><span class="p">;</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">3em</span><span class="p">;</span>
    <span class="nl">line-height</span><span class="p">:</span> <span class="m">3em</span><span class="p">;</span>
    <span class="na">-webkit-tap-highlight-color</span><span class="p">:</span> <span class="nb">transparent</span><span class="p">;</span>
    <span class="k">@include</span> <span class="nd">user-select</span><span class="p">(</span><span class="nb">none</span><span class="p">);</span>
    <span class="nt">-webkit-touch-callout</span><span class="nd">:none</span><span class="p">;</span>
    <span class="nc">.button</span><span class="p">{</span>
        <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
        <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
        <span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
        <span class="nl">top</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
        <span class="nl">left</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
        <span class="nt">svg</span><span class="p">{</span>
            <span class="na">fill</span><span class="p">:</span> <span class="nb">transparent</span><span class="p">;</span> <span class="c1">// 填充透明背景
</span>            <span class="na">stroke</span><span class="p">:</span> <span class="nv">$green</span><span class="p">;</span>    <span class="c1">// 边框颜色
</span>            <span class="na">stroke-width</span><span class="p">:</span> <span class="m">2px</span><span class="p">;</span> <span class="c1">// 
</span>            <span class="na">stroke-linecap</span><span class="p">:</span> <span class="n">round</span><span class="p">;</span> <span class="c1">// 表示描边端点表现方式。可用值有：butt, round, square, inherit
</span>        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nc">.text</span><span class="p">{</span>  <span class="c1">// 文字
</span>        <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
        <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
        <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
        <span class="nl">z-index</span><span class="p">:</span> <span class="m">2000</span><span class="p">;</span>
        <span class="nl">color</span><span class="p">:</span> <span class="nv">$green</span><span class="p">;</span>
        <span class="k">@include</span> <span class="nd">user-select</span><span class="p">(</span><span class="nb">none</span><span class="p">);</span>
        <span class="nt">-webkit-touch-callout</span><span class="nd">:none</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>通过<a href="http://snapsvg.io/">Snap.svg</a>，我们可以将SVG的路径替换成另一个路径。</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="kd">function</span> <span class="nx">extend</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">b</span><span class="p">){</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">b</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">a</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">b</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
            <span class="p">};</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">a</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">SVGButton</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">options</span><span class="p">){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">el</span> <span class="o">=</span> <span class="nx">el</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">extend</span><span class="p">({},</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">);</span>
        <span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="nx">SVGButton</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">speed</span><span class="p">:</span> <span class="p">{</span><span class="na">reset</span><span class="p">:</span> <span class="mi">800</span><span class="p">,</span> <span class="na">active</span><span class="p">:</span> <span class="mi">150</span><span class="p">},</span>
        <span class="na">easing</span><span class="p">:</span> <span class="p">{</span><span class="na">reset</span><span class="p">:</span> <span class="nx">mina</span><span class="p">.</span><span class="nx">elastic</span><span class="p">,</span> <span class="na">active</span><span class="p">:</span><span class="nx">mina</span><span class="p">.</span><span class="nx">easein</span><span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">SVGButton</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'SVGButton Init'</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">shapeEl</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'span.button'</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">Snap</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">shapeEl</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">pathEl</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'path'</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">paths</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">reset</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">pathEl</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">),</span>
            <span class="na">active</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">shapeEl</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">'data-morph-active'</span><span class="p">)</span>
        <span class="p">};</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">initEvents</span><span class="p">();</span>
    <span class="p">};</span>
    <span class="nx">SVGButton</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">initEvents</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'mousedown'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">down</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'touchstart'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">down</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'mouseup'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">up</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'touchend'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">up</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'mouseout'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">up</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
    <span class="p">};</span>
    <span class="nx">SVGButton</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">down</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">pathEl</span><span class="p">.</span><span class="nx">stop</span><span class="p">().</span><span class="nx">animate</span><span class="p">({</span><span class="s1">'path'</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">paths</span><span class="p">.</span><span class="nx">active</span><span class="p">},</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">speed</span><span class="p">.</span><span class="nx">active</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">easing</span><span class="p">.</span><span class="nx">active</span><span class="p">);</span>
    <span class="p">};</span>  
    <span class="nx">SVGButton</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">up</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">pathEl</span><span class="p">.</span><span class="nx">stop</span><span class="p">().</span><span class="nx">animate</span><span class="p">({</span><span class="s1">'path'</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">paths</span><span class="p">.</span><span class="nx">reset</span><span class="p">},</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">speed</span><span class="p">.</span><span class="nx">reset</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">easing</span><span class="p">.</span><span class="nx">reset</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="p">[].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span> <span class="s1">'.SVGButton a'</span> <span class="p">)</span> <span class="p">).</span><span class="nx">forEach</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">el</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">new</span> <span class="nx">SVGButton</span><span class="p">(</span> <span class="nx">el</span> <span class="p">);</span>
    <span class="p">});</span>

<span class="p">})();</span>
</code></pre></div>
<p>正确的形变，和适当动画时间，就可以创造出非常棒的效果。</p>

<p>本例介绍的只是一种简单思路，希望你可以通过本文延伸拓展出更多的效果出来。:)</p>

<hr>

<p><br></p>

<p>相关文章</p>

<blockquote>
<p>SVG动画：弹性按钮</p>

<p><a href="http://www.zwlme.com/codebase/SVGLoading.html">SVG动画：loading 效果</a></p>
</blockquote>

                    </div>
                </div>
                <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'zhuowenli'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
                        <footer class="footer">
            <p class="copyright">© 2015 卓文理 · <a href="/about/" class="about">关于本站</a> · Powered by <a href="http://github.com" class="powered">GitHub</a> &amp; <a href="http://jekyllcn.com" class="powered">Jekyll</a></p>
        </footer>
            </div>
            <div class="post-backdrop"></div>
        </main>

        <script type="text/javascript" src="/res/js/index.js"></script>
        <script type="text/javascript">
            app.init();
        </script>
    </div>
</body>
</html>