<!DOCTYPE html>
<html lang="cn">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

    <link rel="dns-prefetch" href="//disqus.com"/>
    <link rel="dns-prefetch" href="//a.disquscdn.com"/>

    <meta name="Keywords" content="卓文理,前端,前端开发,网页设计,交互设计,media query,css3,w3"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"/>
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="black" name="apple-mobile-web-app-status-bar-style" />
    <meta content="telephone=no" name="format-detection" />
    
    <meta name="author" content="卓文理">

    <link rel="apple-touch-icon-precomposed" href="/res/img/icon.png">
    <link rel="apple-touch-icon-precomposed" href="/res/img/icon-72.png" sizes="72x72" />
    <link rel="apple-touch-icon-precomposed" href="/res/img/icon-76.png" sizes="76x76" />
    <link rel="apple-touch-icon-precomposed" href="/res/img/icon-114.png" sizes="114x114" />
    <link rel="apple-touch-icon-precomposed" href="/res/img/icon-120.png" sizes="120x120" />
    <link rel="apple-touch-icon-precomposed" href="/res/img/icon-152.png" sizes="152x152" />
    <link href="/res/img/icon.png" rel="Shortcut Icon" type="image/x-icon"/>

    <title>浅析 Media Query Level 4 | 卓文理</title>

    
    <link rel="stylesheet" href="/res/css/style.css">
    <script type="text/javascript" src="/res/js/jquery-2.1.1.min.js"></script>
</head>
<body>
    <div id="container" class="container modify">
        <main id="postPage" class="page post-page post-detail">
                <div class="post-menu">
        <a href="/" class="uplevel">
            <span class="arrow">‹</span>
            <strong class="logo">
                <span class="a">卓</span>
                <span class="b">文</span>
                <span class="c">理</span>
            </strong>
            <h1>前端开发</h1>
        </a>
        <ul class="stats">
            <li>
                <p>本站站长</p>
                <p><a target="_blank" href="http://www.zwlme.com">卓文理</a></p>
            </li>
            <li>
                <p>联系方式</p>
                <p><a target="_blank" href="mailto:531840344@qq.com">531840344@qq.com</a></p>
            </li>
        </ul>
    </div>
            <div class="post-container">
                <div class="article">
                    <a href="/frontend" class="back">
                        <span class="arrow">&lt;</span>
                        <span class="text">返回目录</span>
                    </a>
                    <header class="article-info">
                        <h1>浅析 Media Query Level 4</h1>
                    </header>
                    <div class="article-body">
                        <p>目前主流浏览器对CSS3 Media Queries的支持度已经非常好，那么就展望看看<a href="http://dev.w3.org/csswg/mediaqueries-4/">Media Query Level 4</a>。</p>

<p>前段时间抽空看了一下，就挑选几条感兴趣的说下。由于目前文档并非标准而只是工作草案，所以本文所列内容随时可能过期，只作为一个向导。</p>

<h2>update-frequency (更新频度)</h2>

<p>查询设备的实际更新能力，取值也比较直观：</p>

<ul>
<li><code>none</code>: 一旦渲染无法更新(比如打印机)</li>
<li><code>slow</code>: 更新缓慢(比如电子墨水)</li>
<li><code>normal</code>: 正常更新(比如我们更为熟悉的电脑屏幕)</li>
</ul>

<p>这个查询可以为一些带有交互类的内容提供更多的外观控制，因为我们不是指定设备，而是根据设备的实际能力，对最终内容的样式加以优化。</p>

<p>例如，有一个链接在鼠标<code>hover</code>时会有下划线，当我们在打印时需要把下滑线显示出来：</p>
<div class="highlight"><pre><code class="language-scss" data-lang="scss"><span class="nt">a</span><span class="p">{</span>
    <span class="nl">text-decoration</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">a</span><span class="nd">:hover</span><span class="o">,</span> <span class="nt">a</span><span class="nd">:focus</span><span class="p">{</span>
    <span class="nl">text-decoration</span><span class="p">:</span> <span class="nb">underline</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@media</span> <span class="p">(</span><span class="n">update-frequency</span><span class="o">:</span> <span class="nb">none</span><span class="p">){</span>  <span class="c1">// 打印等设备
</span>    <span class="nt">a</span><span class="p">{</span>
        <span class="nl">text-decoration</span><span class="p">:</span> <span class="nb">underline</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2>light-level (环境光)</h2>

<p>Level 4里添加了关于环境光的查询，这使得夜间模式变得可能。当然，现在已经有一些通过页面里的开关实现了类似开关灯的效果，效果其实也挺不错。甚至有一些浏览器单独实现了这样的一个模式，为夜间阅读注入特别的样式(主要是字体反白)。查询环境光需要光感传感器，由于现在手机上普遍已经搭载，所以light-level成为了一个很实际的功能。</p>

<p>目前取值有三：</p>

<ul>
<li><code>dim</code>: (昏暗)</li>
<li><code>normal</code>: (普通)</li>
<li><code>washed</code>: (明亮环境，比如室外阳光下)</li>
</ul>

<p>这个查询看起来不错，不过实际操作起来是非常有难度的，因为很难界定。用户代理必须自己设定光亮的阀值，不同光感组件精度不同，而且手机自有的调亮功能也会影响到准确性，更不要说电子墨水在强光下的反而效果优秀了。所以，就目前而言这个特性显得比较空泛。</p>

<p>下面是一个根据环境光来控制页面显示模式的demo：</p>
<div class="highlight"><pre><code class="language-css" data-lang="css"><span class="k">@media</span> <span class="p">(</span><span class="n">light-level</span><span class="p">:</span> <span class="nb">normal</span><span class="p">)</span> <span class="p">{</span>
    <span class="nt">p</span> <span class="p">{</span> <span class="nl">background</span><span class="p">:</span> <span class="sx">url("texture.jpg")</span><span class="p">;</span> <span class="nl">color</span><span class="p">:</span> <span class="m">#333</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">@media</span> <span class="p">(</span><span class="n">light-level</span><span class="p">:</span> <span class="n">dim</span><span class="p">)</span> <span class="p">{</span>
    <span class="nt">p</span> <span class="p">{</span> <span class="nl">background</span><span class="p">:</span> <span class="m">#222</span><span class="p">;</span> <span class="nl">color</span><span class="p">:</span> <span class="m">#ccc</span> <span class="p">}</span>
<span class="p">}</span>
<span class="k">@media</span> <span class="p">(</span><span class="n">light-level</span><span class="p">:</span> <span class="n">washed</span><span class="p">)</span> <span class="p">{</span>
    <span class="nt">p</span> <span class="p">{</span> <span class="nl">background</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span> <span class="nl">color</span><span class="p">:</span> <span class="no">black</span><span class="p">;</span> <span class="nl">font-size</span><span class="p">:</span> <span class="m">2em</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h1>scripting (脚本能力)</h1>

<p>我们长期依赖<code>noscript</code>标签完成脚本支持的提示，但如果能查询到浏览器的脚本情况而应用不同的样式，岂非更好？所以 <code>scripting</code> 用来查询当前文档对脚本的支持情况。取值同样有三：</p>

<ul>
<li><code>enabled</code>: 支持脚本并且已启用</li>
<li><code>initial-only</code>: 仅支持页面初始化脚本</li>
<li><code>none</code>:    不支持脚本，或虽然支持但未启用</li>
</ul>

<p><code>initial-only</code> 比较少见，但却是有用的，比如对于打印机而言，我们有必要得到仅仅是初始化完成的页面，但可能并不需要其他后续的交互结果。另外，<code>none</code>代表了不支持和不启用两者，是否有必要对两者加以区分？个人认为，没什么必要。区别对待的话，也许我们可以提供更准确的提示语句，然而在这个脚本横行的时代，有点显得多余。</p>

<h2>pointer (指针)</h2>

<p><code>pointer</code>代表了指点的精度，是我看到目前为止，LV4最有用的一个查询。</p>

<p>目前，我们使用媒体查询往往只是通过宽度判断我们的设备大小，我们总是在默认越小的设备诸如平板和手机，其指点精度都不高，故而需要放大按钮的尺寸，尽管大体事实上确实如此，但我们显然需要更为直观的确定方式——直接查询指点的精度。</p>

<p>指点精度影响可以影响整个交互，所以显得额外重要，尤其是当标准试图将所有设备囊括其中时。</p>

<p><code>pointer</code>取值同时有三：</p>

<ul>
<li><code>none</code>: (无指点)</li>
<li><code>coarse</code>: (不精确，比如手指)</li>
<li><code>fine</code>: (精确，比如鼠标)</li>
</ul>

<p>并且，缩放不影响值的判断。</p>

<p>现在，我们就可以更为直观地放大我们的按钮了：</p>
<div class="highlight"><pre><code class="language-css" data-lang="css"><span class="k">@media</span> <span class="p">(</span><span class="nb">pointer</span><span class="p">:</span><span class="n">coarse</span><span class="p">)</span> <span class="p">{</span>
    <span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="err">"</span><span class="nt">checkbox</span><span class="err">"</span><span class="o">],</span> <span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="err">"</span><span class="nt">radio</span><span class="err">"</span><span class="o">]</span> <span class="p">{</span>
        <span class="nl">min-width</span><span class="p">:</span><span class="m">30px</span><span class="p">;</span>
        <span class="nl">min-height</span><span class="p">:</span><span class="m">40px</span><span class="p">;</span>
        <span class="nl">background</span><span class="p">:</span><span class="nb">transparent</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2>hover (悬停)</h2>

<p>另一个重要的查询是 <code>hover</code>，即指点动作是否具有悬停能力。现代浏览器(特别是移动浏览器)对这个东西有各种特别处理。</p>

<p><code>hover</code>同样有3个取值：</p>

<ul>
<li><code>none</code>：设备不支持指针(pointer)，甚至没有指针系统</li>
<li><code>on-demand</code>：设备支持指针系统，但是他需要用户一个特定的操作。比如部分移动设备不能正常hover，但是<strong>长按</strong>的时候可以激活hover</li>
<li><code>hover</code>：正常悬停</li>
</ul>

<p>当设备支持hover时，使用悬停来激活下拉菜单：</p>
<div class="highlight"><pre><code class="language-css" data-lang="css"><span class="k">@media</span> <span class="p">(</span><span class="n">hover</span><span class="p">)</span> <span class="p">{</span>
    <span class="nc">.menu</span> <span class="o">&gt;</span> <span class="nt">li</span>        <span class="p">{</span><span class="nl">display</span><span class="p">:</span><span class="n">inline-block</span><span class="p">;}</span>
    <span class="nc">.menu</span> <span class="nt">ul</span>          <span class="p">{</span><span class="nl">display</span><span class="p">:</span><span class="nb">none</span><span class="p">;</span> <span class="nl">position</span><span class="p">:</span><span class="nb">absolute</span><span class="p">;}</span>
    <span class="nc">.menu</span> <span class="nt">li</span><span class="nd">:hover</span> <span class="nt">ul</span> <span class="p">{</span><span class="nl">display</span><span class="p">:</span><span class="nb">block</span><span class="p">;</span> <span class="nl">list-style</span><span class="p">:</span><span class="nb">none</span><span class="p">;</span> <span class="nl">padding</span><span class="p">:</span><span class="m">0</span><span class="p">;}</span>
    <span class="c">/* ... */</span>
<span class="p">}</span>
</code></pre></div>
<h2>custom Media Queries (自定义查询)</h2>

<p>自定义查询，顾名思义，就是将定义好的某种查询命名，并可以在后续过程中组合使用。相对Level 3，Level 4添加了很多新的查询类型，这使得自定义查询变得有意义。只是即便如此，自定义查询的可用度还是太小了些。</p>

<h2>总结</h2>

<p>以前看Media Query还是遥不可及的梦，但几年一过，变化还真是很大。</p>

<p>所以往前看一些总不会错的。虽然现在还用不上甚至显得鸡肋，但时间当真是转瞬，即逝。</p>

<p>毕竟，IE6都要死拉。啊哈哈哈哈哈哈··· (疯癫状~</p>

                    </div>
                </div>
                <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'zhuowenli'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
                        <footer class="footer">
            <p class="copyright">© 2015 卓文理 · <a href="/about/" class="about">关于本站</a> · Powered by <a href="http://github.com" class="powered">GitHub</a> &amp; <a href="http://jekyllcn.com" class="powered">Jekyll</a></p>
        </footer>
            </div>
            <div class="post-backdrop"></div>
        </main>

        <script type="text/javascript" src="/res/js/index.js"></script>
        <script type="text/javascript">
            app.init();
        </script>
    </div>
</body>
</html>